var e=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,t=new RegExp("[\\-\\.0-9"+e.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),n=new RegExp("^"+e.source+t.source+"*(?::"+e.source+t.source+"*)?$"),r=0,i=1,o=2,a=3,s=4,u=5,c=6,l=7;function d(){}function h(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function f(e,t,n,d,h,f){for(var p,m=++t,N=r;;){var g=e.charAt(m);switch(g){case"=":if(N===i)p=e.slice(t,m),N=a;else{if(N!==o)throw new Error("attribute equal must after attrName");N=a}break;case"'":case'"':if(N===a||N===i){if(N===i&&(f.warning('attribute value must after "="'),p=e.slice(t,m)),t=m+1,!((m=e.indexOf(g,t))>0))throw new Error("attribute value no end '"+g+"' match");v=e.slice(t,m).replace(/&#?\w+;/g,h),n.add(p,v,t-1),N=u}else{if(N!=s)throw new Error('attribute value must after "="');v=e.slice(t,m).replace(/&#?\w+;/g,h),n.add(p,v,t),f.warning('attribute "'+p+'" missed start quot('+g+")!!"),t=m+1,N=u}break;case"/":switch(N){case r:n.setTagName(e.slice(t,m));case u:case c:case l:N=l,n.closed=!0;case s:case i:case o:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return f.error("unexpected end of input"),N==r&&n.setTagName(e.slice(t,m)),m;case">":switch(N){case r:n.setTagName(e.slice(t,m));case u:case c:case l:break;case s:case i:"/"===(v=e.slice(t,m)).slice(-1)&&(n.closed=!0,v=v.slice(0,-1));case o:N===o&&(v=p),N==s?(f.warning('attribute "'+v+'" missed quot(")!!'),n.add(p,v.replace(/&#?\w+;/g,h),t)):("http://www.w3.org/1999/xhtml"===d[""]&&v.match(/^(?:disabled|checked|selected)$/i)||f.warning('attribute "'+v+'" missed value!! "'+v+'" instead!!'),n.add(v,v,t));break;case a:throw new Error("attribute value missed!!")}return m;case"":g=" ";default:if(g<=" ")switch(N){case r:n.setTagName(e.slice(t,m)),N=c;break;case i:p=e.slice(t,m),N=o;break;case s:var v=e.slice(t,m).replace(/&#?\w+;/g,h);f.warning('attribute "'+v+'" missed quot(")!!'),n.add(p,v,t);case u:N=c}else switch(N){case o:n.tagName;"http://www.w3.org/1999/xhtml"===d[""]&&p.match(/^(?:disabled|checked|selected)$/i)||f.warning('attribute "'+p+'" missed value!! "'+p+'" instead2!!'),n.add(p,p,t),t=m,N=i;break;case u:f.warning('attribute space is required"'+p+'"!!');case c:N=i,t=m;break;case a:N=s,t=m;break;case l:throw new Error("elements closed character '/' and '>' must be connected to")}}m++}}function p(e,t,n){for(var r=e.tagName,i=null,o=e.length;o--;){var a=e[o],s=a.qName,u=a.value;if((h=s.indexOf(":"))>0)var c=a.prefix=s.slice(0,h),l=s.slice(h+1),d="xmlns"===c&&l;else l=s,c=null,d="xmlns"===s&&"";a.localName=l,!1!==d&&(null==i&&(i={},g(n,n={})),n[d]=i[d]=u,a.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(d,u))}for(o=e.length;o--;){(c=(a=e[o]).prefix)&&("xml"===c&&(a.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==c&&(a.uri=n[c||""]))}var h;(h=r.indexOf(":"))>0?(c=e.prefix=r.slice(0,h),l=e.localName=r.slice(h+1)):(c=null,l=e.localName=r);var f=e.uri=n[c||""];if(t.startElement(f,l,r,e),!e.closed)return e.currentNSMap=n,e.localNSMap=i,!0;if(t.endElement(f,l,r),i)for(c in i)t.endPrefixMapping(c)}function m(e,t,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var o=e.indexOf("</"+n+">",t),a=e.substring(t+1,o);if(/[&<]/.test(a))return/^script$/i.test(n)?(i.characters(a,0,a.length),o):(a=a.replace(/&#?\w+;/g,r),i.characters(a,0,a.length),o)}return t+1}function N(e,t,n,r){var i=r[n];return null==i&&((i=e.lastIndexOf("</"+n+">"))<t&&(i=e.lastIndexOf("</"+n)),r[n]=i),i<t}function g(e,t){for(var n in e)t[n]=e[n]}function v(e,t,n,r){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(i=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,i-t-4),i+3):(r.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var i=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,i-t-9),n.endCDATA(),i+3}var o=function(e,t){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=t,i.exec(e);for(;n=i.exec(e);)if(r.push(n),n[1])return r}(e,t),a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var s=o[1][0],u=a>3&&/^public$/i.test(o[2][0])&&o[3][0],c=a>4&&o[4][0],l=o[a-1];return n.startDTD(s,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),c&&c.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),l.index+l[0].length}}return-1}function w(e,t,n){var r=e.indexOf("?>",t);if(r){var i=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){i[0].length;return n.processingInstruction(i[1],i[2]),r+2}return-1}return-1}function b(e){}function E(e,t){return e.__proto__=t,e}d.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),g(t,t={}),function(e,t,n,r,i){function o(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(i.error("entity not found:"+e),e)}function a(t){if(t>y){var n=e.substring(y,t).replace(/&#?\w+;/g,o);d&&s(y),r.characters(n,0,t-y),y=t}}function s(t,n){for(;t>=c&&(n=l.exec(e));)u=n.index,c=u+n[0].length,d.lineNumber++;d.columnNumber=t-u+1}var u=0,c=0,l=/.*(?:\r\n?|\n)|.*$/g,d=r.locator,g=[{currentNSMap:t}],E={},y=0;for(;;){try{var x=e.indexOf("<",y);if(x<0){if(!e.substr(y).match(/^\s*$/)){var D=r.doc,T=D.createTextNode(e.substr(y));D.appendChild(T),r.currentElement=T}return}switch(x>y&&a(x),e.charAt(x+1)){case"/":var S=e.indexOf(">",x+3),C=e.substring(x+2,S),_=g.pop();S<0?(C=e.substring(x+2).replace(/[\s<].*/,""),i.error("end tag name: "+C+" is not complete:"+_.tagName),S=x+1+C.length):C.match(/\s</)&&(C=C.replace(/[\s<].*/,""),i.error("end tag name: "+C+" maybe not complete"),S=x+1+C.length);var I=_.localNSMap,A=_.tagName==C;if(A||_.tagName&&_.tagName.toLowerCase()==C.toLowerCase()){if(r.endElement(_.uri,_.localName,C),I)for(var R in I)r.endPrefixMapping(R);A||i.fatalError("end tag name: "+C+" is not match the current start tagName:"+_.tagName)}else g.push(_);S++;break;case"?":d&&s(x),S=w(e,x,r);break;case"!":d&&s(x),S=v(e,x,r,i);break;default:d&&s(x);var O=new b,M=g[g.length-1].currentNSMap,k=(S=f(e,x,O,M,o,i),O.length);if(!O.closed&&N(e,S,O.tagName,E)&&(O.closed=!0,n.nbsp||i.warning("unclosed xml attribute")),d&&k){for(var L=h(d,{}),F=0;F<k;F++){var U=O[F];s(U.offset),U.locator=h(d,{})}r.locator=L,p(O,r,M)&&g.push(O),r.locator=d}else p(O,r,M)&&g.push(O);"http://www.w3.org/1999/xhtml"!==O.uri||O.closed?S++:S=m(e,S,O.tagName,o,r)}}catch(e){i.error("element parse error: "+e),S=-1}S>y?y=S:a(Math.max(x,y)+1)}}(e,t,n,r,this.errorHandler),r.endDocument()}},b.prototype={setTagName:function(e){if(!n.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,r){if(!n.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},E({},E.prototype)instanceof E||(E=function(e,t){function n(){}for(t in n.prototype=t,n=new n,e)n[t]=e[t];return n});var y={XMLReader:d};function x(e,t){for(var n in e)t[n]=e[n]}function D(e,t){var n=e.prototype;if(Object.create){var r=Object.create(t.prototype);n.__proto__=r}if(!(n instanceof t)){function i(){}i.prototype=t.prototype,x(n,i=new i),e.prototype=n=i}n.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),n.constructor=e)}var T="http://www.w3.org/1999/xhtml",S={},C=S.ELEMENT_NODE=1,_=S.ATTRIBUTE_NODE=2,I=S.TEXT_NODE=3,A=S.CDATA_SECTION_NODE=4,R=S.ENTITY_REFERENCE_NODE=5,O=S.ENTITY_NODE=6,M=S.PROCESSING_INSTRUCTION_NODE=7,k=S.COMMENT_NODE=8,L=S.DOCUMENT_NODE=9,F=S.DOCUMENT_TYPE_NODE=10,U=S.DOCUMENT_FRAGMENT_NODE=11,$=S.NOTATION_NODE=12,P={},B={},V=(P.INDEX_SIZE_ERR=(B[1]="Index size error",1),P.DOMSTRING_SIZE_ERR=(B[2]="DOMString size error",2),P.HIERARCHY_REQUEST_ERR=(B[3]="Hierarchy request error",3)),q=(P.WRONG_DOCUMENT_ERR=(B[4]="Wrong document",4),P.INVALID_CHARACTER_ERR=(B[5]="Invalid character",5),P.NO_DATA_ALLOWED_ERR=(B[6]="No data allowed",6),P.NO_MODIFICATION_ALLOWED_ERR=(B[7]="No modification allowed",7),P.NOT_FOUND_ERR=(B[8]="Not found",8)),j=(P.NOT_SUPPORTED_ERR=(B[9]="Not supported",9),P.INUSE_ATTRIBUTE_ERR=(B[10]="Attribute in use",10));P.INVALID_STATE_ERR=(B[11]="Invalid state",11),P.SYNTAX_ERR=(B[12]="Syntax error",12),P.INVALID_MODIFICATION_ERR=(B[13]="Invalid modification",13),P.NAMESPACE_ERR=(B[14]="Invalid namespace",14),P.INVALID_ACCESS_ERR=(B[15]="Invalid access",15);function X(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,B[e]),this.message=B[e],Error.captureStackTrace&&Error.captureStackTrace(this,X);return n.code=e,t&&(this.message=this.message+": "+t),n}function z(){}function H(e,t){this._node=e,this._refresh=t,Y(this)}function Y(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var n=e._refresh(e._node);xe(e,"length",n.length),x(n,e),e._inc=t}}function W(){}function G(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function K(e,t,n,r){if(r?t[G(t,r)]=n:t[t.length++]=n,e){n.ownerElement=e;var i=e.ownerDocument;i&&(r&&re(i,e,r),function(e,t,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(t._nsMap[n.prefix?n.localName:""]=n.value)}(i,e,n))}}function Q(e,t,n){var r=G(t,n);if(!(r>=0))throw X(q,new Error(e.tagName+"@"+n));for(var i=t.length-1;r<i;)t[r]=t[++r];if(t.length=i,e){var o=e.ownerDocument;o&&(re(o,e,n),n.ownerElement=null)}}function Z(e){if(this._features={},e)for(var t in e)this._features=e[t]}function J(){}function ee(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function te(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(te(e,t))return!0}while(e=e.nextSibling)}function ne(){}function re(e,t,n,r){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete t._nsMap[n.prefix?n.localName:""]}function ie(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{for(var i=t.firstChild,o=0;i;)r[o++]=i,i=i.nextSibling;r.length=o}}}function oe(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,ie(e.ownerDocument,e),t}function ae(e,t,n){var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===U){var i=t.firstChild;if(null==i)return t;var o=t.lastChild}else i=o=t;var a=n?n.previousSibling:e.lastChild;i.previousSibling=a,o.nextSibling=n,a?a.nextSibling=i:e.firstChild=i,null==n?e.lastChild=o:n.previousSibling=o;do{i.parentNode=e}while(i!==o&&(i=i.nextSibling));return ie(e.ownerDocument||e,e),t.nodeType==U&&(t.firstChild=t.lastChild=null),t}function se(){this._nsMap={}}function ue(){}function ce(){}function le(){}function de(){}function he(){}function fe(){}function pe(){}function me(){}function Ne(){}function ge(){}function ve(){}function we(){}function be(e,t){var n=[],r=9==this.nodeType?this.documentElement:this,i=r.prefix,o=r.namespaceURI;if(o&&null==i&&null==(i=r.lookupPrefix(o)))var a=[{namespace:o,prefix:null}];return ye(this,n,e,t,a),n.join("")}function Ee(e,t,n){var r=e.prefix||"",i=e.namespaceURI;if(!r&&!i)return!1;if("xml"===r&&"http://www.w3.org/XML/1998/namespace"===i||"http://www.w3.org/2000/xmlns/"==i)return!1;for(var o=n.length;o--;){var a=n[o];if(a.prefix==r)return a.namespace!=i}return!0}function ye(e,t,n,r,i){if(r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case C:i||(i=[]);i.length;var o=e.attributes,a=o.length,s=e.firstChild,u=e.tagName;n=T===e.namespaceURI||n,t.push("<",u);for(var c=0;c<a;c++){"xmlns"==(l=o.item(c)).prefix?i.push({prefix:l.localName,namespace:l.value}):"xmlns"==l.nodeName&&i.push({prefix:"",namespace:l.value})}for(c=0;c<a;c++){var l;if(Ee(l=o.item(c),0,i)){var d=l.prefix||"",h=l.namespaceURI,f=d?" xmlns:"+d:" xmlns";t.push(f,'="',h,'"'),i.push({prefix:d,namespace:h})}ye(l,t,n,r,i)}if(Ee(e,0,i)){d=e.prefix||"",h=e.namespaceURI,f=d?" xmlns:"+d:" xmlns";t.push(f,'="',h,'"'),i.push({prefix:d,namespace:h})}if(s||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(t.push(">"),n&&/^script$/i.test(u))for(;s;)s.data?t.push(s.data):ye(s,t,n,r,i),s=s.nextSibling;else for(;s;)ye(s,t,n,r,i),s=s.nextSibling;t.push("</",u,">")}else t.push("/>");return;case L:case U:for(s=e.firstChild;s;)ye(s,t,n,r,i),s=s.nextSibling;return;case _:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,ee),'"');case I:return t.push(e.data.replace(/[<&]/g,ee));case A:return t.push("<![CDATA[",e.data,"]]>");case k:return t.push("\x3c!--",e.data,"--\x3e");case F:var p=e.publicId,m=e.systemId;if(t.push("<!DOCTYPE ",e.name),p)t.push(' PUBLIC "',p),m&&"."!=m&&t.push('" "',m),t.push('">');else if(m&&"."!=m)t.push(' SYSTEM "',m,'">');else{var N=e.internalSubset;N&&t.push(" [",N,"]"),t.push(">")}return;case M:return t.push("<?",e.target," ",e.data,"?>");case R:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function xe(e,t,n){e[t]=n}X.prototype=Error.prototype,x(P,X),z.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],r=0;r<this.length;r++)ye(this[r],n,e,t);return n.join("")}},H.prototype.item=function(e){return Y(this),this[e]},D(H,z),W.prototype={length:0,item:z.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new X(j);var n=this.getNamedItem(e.nodeName);return K(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new X(j);return t=this.getNamedItemNS(e.namespaceURI,e.localName),K(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return Q(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return Q(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var r=this[n];if(r.localName==t&&r.namespaceURI==e)return r}return null}},Z.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var r=new ne;if(r.implementation=this,r.childNodes=new z,r.doctype=n,n&&r.appendChild(n),t){var i=r.createElementNS(e,t);r.appendChild(i)}return r},createDocumentType:function(e,t,n){var r=new fe;return r.name=e,r.nodeName=e,r.publicId=t,r.systemId=n,r}},J.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return ae(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return oe(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,n,r){var i=new n.constructor;for(var o in n){var a=n[o];"object"!=typeof a&&a!=i[o]&&(i[o]=a)}n.childNodes&&(i.childNodes=new z);i.ownerDocument=t;switch(i.nodeType){case C:var s=n.attributes,u=i.attributes=new W,c=s.length;u._ownerElement=i;for(var l=0;l<c;l++)i.setAttributeNode(e(t,s.item(l),!0));break;case _:r=!0}if(r)for(var d=n.firstChild;d;)i.appendChild(e(t,d,r)),d=d.nextSibling;return i}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==I&&e.nodeType==I?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var r in n)if(n[r]==e)return r;t=t.nodeType==_?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==_?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},x(S,J),x(S,J.prototype),ne.prototype={nodeName:"#document",nodeType:L,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==U){for(var n=e.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,t),n=r}return e}return null==this.documentElement&&e.nodeType==C&&(this.documentElement=e),ae(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),oe(this,e)},importNode:function(e,t){return function e(t,n,r){var i;switch(n.nodeType){case C:(i=n.cloneNode(!1)).ownerDocument=t;case U:break;case _:r=!0}i||(i=n.cloneNode(!1));i.ownerDocument=t;i.parentNode=null;if(r)for(var o=n.firstChild;o;)i.appendChild(e(t,o,r)),o=o.nextSibling;return i}(this,e,t)},getElementById:function(e){var t=null;return te(this.documentElement,function(n){if(n.nodeType==C&&n.getAttribute("id")==e)return t=n,!0}),t},createElement:function(e){var t=new se;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new z,(t.attributes=new W)._ownerElement=t,t},createDocumentFragment:function(){var e=new ge;return e.ownerDocument=this,e.childNodes=new z,e},createTextNode:function(e){var t=new le;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new de;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new he;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new ve;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new ue;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new Ne;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new se,r=t.split(":"),i=n.attributes=new W;return n.childNodes=new z,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,i._ownerElement=n,n},createAttributeNS:function(e,t){var n=new ue,r=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},D(ne,J),se.prototype={nodeType:C,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===U?this.insertBefore(e,null):function(e,t){var n=t.parentNode;if(n){var r=e.lastChild;n.removeChild(t);r=e.lastChild}return r=e.lastChild,t.parentNode=e,t.previousSibling=r,t.nextSibling=null,r?r.nextSibling=t:e.firstChild=t,e.lastChild=t,ie(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new H(this,function(t){var n=[];return te(t,function(r){r===t||r.nodeType!=C||"*"!==e&&r.tagName!=e||n.push(r)}),n})},getElementsByTagNameNS:function(e,t){return new H(this,function(n){var r=[];return te(n,function(i){i===n||i.nodeType!==C||"*"!==e&&i.namespaceURI!==e||"*"!==t&&i.localName!=t||r.push(i)}),r})}},ne.prototype.getElementsByTagName=se.prototype.getElementsByTagName,ne.prototype.getElementsByTagNameNS=se.prototype.getElementsByTagNameNS,D(se,J),ue.prototype.nodeType=_,D(ue,J),ce.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(B[V])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},D(ce,J),le.prototype={nodeName:"#text",nodeType:I,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},D(le,ce),de.prototype={nodeName:"#comment",nodeType:k},D(de,ce),he.prototype={nodeName:"#cdata-section",nodeType:A},D(he,ce),fe.prototype.nodeType=F,D(fe,J),pe.prototype.nodeType=$,D(pe,J),me.prototype.nodeType=O,D(me,J),Ne.prototype.nodeType=R,D(Ne,J),ge.prototype.nodeName="#document-fragment",ge.prototype.nodeType=U,D(ge,J),ve.prototype.nodeType=M,D(ve,J),we.prototype.serializeToString=function(e,t,n){return be.call(e,t,n)},J.prototype.toString=be;try{if(Object.defineProperty){Object.defineProperty(H.prototype,"length",{get:function(){return Y(this),this.$$length}}),Object.defineProperty(J.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case C:case U:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case C:case U:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),xe=function(e,t,n){e["$$"+t]=n}}}catch(e){}var De,Te={DOMImplementation:Z,XMLSerializer:we},Se=(function(e,t){function n(e){this.options=e||{locator:{}}}function r(){this.cdata=!1}function i(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function o(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function a(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function s(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}n.prototype.parseFromString=function(e,t){var n=this.options,i=new u,a=n.domBuilder||new r,s=n.errorHandler,c=n.locator,l=n.xmlns||{},d={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return c&&a.setDocumentLocator(c),i.errorHandler=function(e,t,n){if(!e){if(t instanceof r)return t;e=t}var i={},a=e instanceof Function;function s(t){var r=e[t];!r&&a&&(r=2==e.length?function(n){e(t,n)}:e),i[t]=r&&function(e){r("[xmldom "+t+"]\t"+e+o(n))}||function(){}}return n=n||{},s("warning"),s("error"),s("fatalError"),i}(s,a,c),i.domBuilder=n.domBuilder||a,/\/x?html?$/.test(t)&&(d.nbsp=" ",d.copy="©",l[""]="http://www.w3.org/1999/xhtml"),l.xml=l.xml||"http://www.w3.org/XML/1998/namespace",e?i.parse(e,l,d):i.errorHandler.error("invalid doc source"),a.doc},r.prototype={startDocument:function(){this.doc=(new c).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,r){var o=this.doc,a=o.createElementNS(e,n||t),u=r.length;s(this,a),this.currentElement=a,this.locator&&i(this.locator,a);for(var c=0;c<u;c++){e=r.getURI(c);var l=r.getValue(c),d=(n=r.getQName(c),o.createAttributeNS(e,n));this.locator&&i(r.getLocator(c),d),d.value=d.nodeValue=l,a.setAttributeNode(d)}},endElement:function(e,t,n){var r=this.currentElement;r.tagName,this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&i(this.locator,n),s(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=a.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(e);else r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&i(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=a.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&i(this.locator,r),s(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var o=r.createDocumentType(e,t,n);this.locator&&i(this.locator,o),s(this,o)}},warning:function(e){console.warn("[xmldom warning]\t"+e,o(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,o(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,o(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){r.prototype[e]=function(){return null}});var u=y.XMLReader,c=t.DOMImplementation=Te.DOMImplementation;t.XMLSerializer=Te.XMLSerializer,t.DOMParser=n}(De={exports:{}},De.exports),De.exports);Se.DOMImplementation,Se.XMLSerializer,Se.DOMParser;function Ce(e){if("param"!==e.prefix)return"id"===e.name.toLowerCase()?`ids:ADD("${e.value}", node).`:`set node:${e.name} to ${e.value}.`}function _e(e){if("param"===e.prefix)return e.value}function Ie(e){switch(e.nodeType){case e.TEXT_NODE:return function(e){let t=e.data.trim();return t?`  set node:text to "${t}".`:""}(e);case e.ELEMENT_NODE:return function(e){let t=[];if(e.childNodes){t.push("\n  //childnodes");for(let n=0;n<e.childNodes.length;n++){const r=e.childNodes[n];Ie(r)&&t.push(Ie(r))}}let n=[],r=[];if(e.attributes){n.push("\n  //attributes");for(let t=0;t<e.attributes.length;t++){const i=e.attributes[t],o=Ce(i);o&&n.push(o);const a=_e(i);a&&r.push(a)}}return("{\n  local parent is node.\n"+`  local node is parent:add${e.tagName}(${r.join(", ")}).\n`+"  "+n.join("\n  ")+"\n  "+t.join("\n")+"\n}").split("\n").map(e=>"  "+e).join("\n")}(e);case e.DOCUMENT_NODE:return function(e){let t=[];if(e.childNodes)for(let n=0;n<e.childNodes.length;n++){const r=e.childNodes[n];t.push(Ie(r))}return`parameter node.\nparameter ids is LEX().\n${t.join("\n")}\n`}(e);default:return""}}const Ae=ace.edit(document.querySelector("#editor"));window.matchMedia("(prefers-color-scheme: dark)").matches&&Ae.setTheme("ace/theme/twilight"),Ae.session.setMode("ace/mode/xml");const Re={error:document.querySelector("#error"),output:document.querySelector("#output")};function Oe(e,t){const n=(r=e,i=t,Ie(new Se.DOMParser({errorHandler:i}).parseFromString(r,"text/html")));var r,i;return"// This code is generated using KSML (lucaelin.github.io/ksml)\n// KSML-Source: ~"+btoa(unescape(encodeURIComponent(e)))+"~\n"+n}function Me(){const e=Ae.getValue();Re.error.innerText="",Re.error.style.display="none";const t=Oe(e,e=>{Re.error.innerText=e,Re.error.style.display="block"});return Re.output.innerText=t,Re.output.classList.add("autoselect"),t}document.querySelector("#convert").addEventListener("click",Me),document.querySelector("#download").addEventListener("click",function(){const e=Me(),t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download","interface.ksml.ks"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}),document.querySelector("#upload").addEventListener("click",function(){const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("hidden",!0),document.body.appendChild(e),e.addEventListener("change",function(t){new Response(e.files[0]).text().then(function(e){const t=e.split("\n").filter(e=>e.startsWith("// KSML-Source: ~"));if(t.length){const[e,n]=t[0].split("~");Ae.setValue(atob(n))}else Ae.setValue(e);Me()})}),e.click(),document.body.removeChild(e)});
//# sourceMappingURL=browser.js.map
